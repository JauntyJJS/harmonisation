[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Harmonisation Template for Cohort A",
    "section": "",
    "text": "Preface\nHere is the documentation of the data harmonisation step generated using Quarto. To learn more about Quarto books visit https://quarto.org/docs/books.",
    "crumbs": [
      "Preface"
    ]
  },
  {
    "objectID": "index.html#acknowledgement",
    "href": "index.html#acknowledgement",
    "title": "Harmonisation Template for Cohort A",
    "section": "Acknowledgement",
    "text": "Acknowledgement\nLayout of this page is inspired from R package rcompendium.",
    "crumbs": [
      "Preface"
    ]
  },
  {
    "objectID": "index.html#file-structure",
    "href": "index.html#file-structure",
    "title": "Harmonisation Template for Cohort A",
    "section": "File Structure",
    "text": "File Structure\nHere is the file structure of this project.\nharmonisation_template/                   # Root of the compendium\n│\n├── harmonisation_template.Rproj          # RStudio project file\n|\n├── .quarto/                              # Intermediate files/folders generated \n|                                         # Quarto renders to the documents.\n|\n├── archive/                              # Folder to keep previous books and harmonised data\n│   ├── reports/                          # Folder containing previous documentation \n|   |                                     # of data harmonisation \n|   └── harmonised/                       # Folder containing previous GPS-CAD harmonised data\n|  \n├── reports/                              # Documentation of data harmonisation \n│  \n├── data-raw/                             # Cohort raw data (.csv, .gpkg, etc.)\n│   ├── {cohort name}/                    # Folder containing cohort raw data,\n|   |                                     # and data dictionary \n|   └── data-dictionary/                  # Data dictionary for harmonised data\n|   └── data-input/                       # Data input file from collaborators\n|  \n├── docs/                                 # R functions documentation generating using\n|                                         # pkgdown:::build_site_external()\n|  \n├── inst/                                 # Arbitrary additional files to include in the\n|   |                                     # package.\n|   |  \n|   └── WORDLIST                          # File generating by spelling::update_wordlist()\n|  \n├── man/                                  # R functions helps (automatically updated)\n│   ├── {fun-demo}.Rd                     # Documentation of the demo R function\n│   └── harmonisation-template.Rd         # High-level documentation\n|  \n├── quarto-yaml-template/                 # Folder containing template files for quarto book generation\n│   ├── _quarto_{cohort name}.yml         # Quarto book generation for each cohort\n│   └── _quarto_all.yml                   # Quarto book generation for all cohorts\n|  \n├── R/                                    # R functions location\n│   ├── {fun-demo}.R                      # Example of an R function\n│   └── harmonisation-template-package.R  # Dummy R file for high-level documentation\n│  \n├── renv/                                 # Folder that contains all packages \n|                                         # installed in the renv environment.\n|        \n├── codes/                                # R/Quarto scripts to run data harmonisation\n|   ├── quarto_script.R                   # R script to render each {cohort name}_Cleaning/ folder. \n|   |                                     # folder into html, pdf and word document.\n│   ├── {cohort name}_Cleaning/           # Quarto scripts to run data harmonisation\n|   |                                     # and output them for each cohort.\n|   └── Combine/                          # Quarto scripts to filter harmonised data\n|                                         # based on inclusion/exclusion criteria, \n|   |                                     # combined the filtered data for preliminary analysis.\n|        \n├── tests/                                # Test units file created by R package testhat\n│        \n├── .lintr                                # Configuration for linting\n|                                         # R projects and packages using linter\n|        \n├── .Rbuildignore                         # List of files/folders to be ignored while \n│                                         # checking/installing the package\n|        \n├── .renvignore                           # List of files/folders to be ignored when \n│                                         # renv is doing its snapshot\n|        \n├── _pkgdown.yml                          # Configuration for R package documentation\n|                                         # using pkgdown:::build_site_external()\n|        \n├── _quarto.yml                           # Configuration for Quarto book generation\n|                                         # Also the project configuration file\n|        \n├── custom-reference.docx                 # Microsoft word template for data harmonisation \n|                                         # documentation to Word\n|        \n├── DESCRIPTION                           # Project metadata[*]\n|        \n├── index.qmd                             # Home page of Quarto book content\n|        \n├── LICENSE                               # Content of the MIT license generated via\n|                                         # usethis::use_mit_license()\n├── LICENSE.md                            # Content of the MIT license generated via\n|                                         # usethis::use_mit_license()\n|        \n├── NAMESPACE                             # Automatically generated\n│        \n├── README.md                             # GitHub README (automatically generated)\n├── README.Rmd                            # GitHub README (ignore for now)\n│      \n|      \n├── references.bib                        # Bibtex file for Quarto book \n|      \n├── references.qmd                        # Reference document for Quarto book\n|      \n├── renv.lock                             # Metadata of R packages installed generated\n|                                         # using renv::snapshot\n|      \n├── csl_file.csl                          # Citation Style Language (CSL) file to ensure\n|                                         # citations follows the Lancet journal\n\n\n[*] These files are automatically created but user needs to manually add some information.",
    "crumbs": [
      "Preface"
    ]
  },
  {
    "objectID": "index.html#installation",
    "href": "index.html#installation",
    "title": "Harmonisation Template for Cohort A",
    "section": "Installation",
    "text": "Installation\n\nInstalling R\nGo to https://cran.rstudio.com/. Choose a version of R that matches the computer’s operating system.\n\n\nInstalling RStudio\nGo to https://posit.co/download/rstudio-desktop/. Scroll down and choose a version of RStudio that matches the computer’s operating system.\n\n\nInstalling Rtools\nGo to https://cran.r-project.org/bin/windows/Rtools/. Choose a version of Rtools that matches the R version that was installed.\n\n\nQuarto\nQuarto converts R scripts into a technical report or notebook in html, pdf, Microsoft Word, etc. It is installed together with RStudio. User can also go to https://quarto.org/docs/get-started/ to install it separately. For Quarto to be able to create pdf files, a pdf engine must be installed as well. For ease, it is suggested to install TinyTex using the terminal command quarto install tinytex.",
    "crumbs": [
      "Preface"
    ]
  },
  {
    "objectID": "index.html#r-package-installation",
    "href": "index.html#r-package-installation",
    "title": "Harmonisation Template for Cohort A",
    "section": "R Package Installation",
    "text": "R Package Installation\nUse Posit Public Package Manager PPM to set up your repository environment to install R packages from CRAN. This is because PPM allows installation of frozen R package versions based on a snapshot date.\nOne way to do that is to set in the .Rprofile file with the code options(repos = c(P3M = \"{link to repository url form Posit Public Package Manager}\"))\nR packages can be installed using the package pak as an alternative to install.packages() and remotes::install_github()](https://remotes.r-lib.org/reference/install_github.html). Benefits of using [pak` can be found here\nYou can also view your respository environment using the command pak::repo_get()\nR package can be loaded using the command library({package_name}). You can use the R package annotater to add additional information on what the loaded package does.",
    "crumbs": [
      "Preface"
    ]
  },
  {
    "objectID": "index.html#using-renv",
    "href": "index.html#using-renv",
    "title": "Harmonisation Template for Cohort A",
    "section": "Using renv",
    "text": "Using renv\nYou can increase reproducibility by using the package renv. Install renv from CRAN with pak::pak(\"renv\"). If this is your first time using renv, start with the Introduction to renv vignette. Use renv::init(bare = TRUE) to start with an empty renv environment.\nrenv will freeze the exact package versions you depend on (in renv.lock). This ensures that each collaborator (or you in the future) will use the exact same versions of these packages. Moreover renv provides to each project its own private package library making each project isolated from others.\nInstall required dependencies locally with install.packages() or renv::install() from CRAN, Bioconductor, Github, explicit file path, etc.\nSometimes the right downloader (libcurl or others) needs to set for installation of R packages inside the renv environment to be successful. Setting the R environmental variable RENV_DOWNLOAD_FILE_METHOD = “libcurl” may help.\nSave the local environment with renv::snapshot() to create the renv.lock file.",
    "crumbs": [
      "Preface"
    ]
  },
  {
    "objectID": "index.html#r-functions-management",
    "href": "index.html#r-functions-management",
    "title": "Harmonisation Template for Cohort A",
    "section": "R Functions Management",
    "text": "R Functions Management\nR functions heavily used in this project can be found in the R folder. Documentation (man folder), test units (test folder) corresponding to these functions are structured the same as creating an R package. Relevant R packages required for R package development (and available on Posit Public Package Manager PPM) are\n\n\nCode\nlibrary(\"usethis\")\nlibrary(\"devtools\")\nlibrary(\"roxygen2\")\nlibrary(\"testthat\")\nlibrary(\"covr\")\nlibrary(\"spelling\")\nlibrary(\"lintr\")\nlibrary(\"sinew\")\nlibrary(\"pkgdown\")\n\n\nHere is an example of the command to use pak::pak(\"{package name}\") to install packages from PPM.\nThere is no need to source the functions in the R folder. Use devtools::load_all() instead. devtools::load_all() will load required dependencies listed in DESCRIPTION and R functions stored in R/. Prior installation of these dependencies is required for the load to be successful.\nAfter loading, R functions can be documented (using devtools::document()), tested (using devtools::test() and then devtools::check()) and even installed as an R package (using devtools::install).\nMore information of this workflow can be found in Chapter 1: The Whole Game of the R Packages (2e) book.",
    "crumbs": [
      "Preface"
    ]
  },
  {
    "objectID": "index.html#r-packages",
    "href": "index.html#r-packages",
    "title": "Harmonisation Template for Cohort A",
    "section": "R Packages",
    "text": "R Packages\nR packages installed from Posit Public Package Manager PPM using command pak::pak(\"{package name}\") are\n\n\nCode\nlibrary(\"renv\")\nlibrary(\"sessioninfo\")\nlibrary(\"knitr\")\nlibrary(\"rmarkdown\")\nlibrary(\"quarto\")\nlibrary(\"rlang\")\nlibrary(\"cli\")\n\nlibrary(\"fs\")\nlibrary(\"here\")\nlibrary(\"fst\")\nlibrary(\"readxl\")\nlibrary(\"vroom\")\n\nlibrary(\"dplyr\")\nlibrary(\"tidyr\")\nlibrary(\"magrittr\")\nlibrary(\"stringr\")\nlibrary(\"forcats\")\nlibrary(\"purrr\")\nlibrary(\"lubridate\")\nlibrary(\"tibble\")\nlibrary(\"glue\")\n\nlibrary(\"collateral\")\nlibrary(\"pointblank\")\nlibrary(\"testthat\")\n\nlibrary(\"htmltools\")\nlibrary(\"htmlwidgets\")\nlibrary(\"fontawesome\")\nlibrary(\"reactable\")\nlibrary(\"flextable\")\n\nlibrary(\"openxlsx\")\n\nlibrary(\"harmonisation\")\n\n\nHere are all the R packages used in this analysis.\n\n\nCode\nif (params$show_table && knitr::is_html_output()) {\n  harmonisation::get_r_package_info() |&gt;\n    reactable::reactable()\n}",
    "crumbs": [
      "Preface"
    ]
  },
  {
    "objectID": "index.html#r-platform-information",
    "href": "index.html#r-platform-information",
    "title": "Harmonisation Template for Cohort A",
    "section": "R Platform Information",
    "text": "R Platform Information\nHere are the R platform environment used in this analysis.\n\n\nCode\nif (params$show_table && knitr::is_html_output()) {\n  r_platform_table &lt;- harmonisation::get_r_platform_info()\n  r_platform_table |&gt;\n    reactable::reactable(\n      defaultPageSize = 5\n    )\n}",
    "crumbs": [
      "Preface"
    ]
  },
  {
    "objectID": "index.html#description",
    "href": "index.html#description",
    "title": "Harmonisation Template for Cohort A",
    "section": "DESCRIPTION",
    "text": "DESCRIPTION\nThe DESCRIPTION file contains important compendium metadata. Though DESCRIPTION file is specific to R package, it can be used to work with research compendia (see below). For further information on how to edit this file, please read https://r-pkgs.org/description.html.",
    "crumbs": [
      "Preface"
    ]
  },
  {
    "objectID": "index.html#data-harmonisation",
    "href": "index.html#data-harmonisation",
    "title": "Harmonisation Template for Cohort A",
    "section": "Data Harmonisation",
    "text": "Data Harmonisation\nTo start the harmonisation of data, run the R script quarto_script.R in reports folder.\nFor each cohort, the script will clean the raw data and create a Quarto book for each cohort in html, word and pdf.\nThis involves copying a specific yml file (_quarto_{cohort name}.yml) from the quarto-yaml-template folder to the project folder harmonisation_template and rename it as _quarto.yml, overwriting any existing _quarto.yml file. Using the _quarto.yml file. Quarto will then start running the Quarto scripts in the reports/{cohort_name}_Cleaning folder. This involves reading the raw data in the data-raw/{cohort_name} folder, placing preprocessing data in the reports/{cohort_name}_Cleaning/preprocessed_data folder, outputting the harmonised data as excel file called cleaned_{cohort_name}.xlsx in the reports folder. Also, the data harmonisation process documentation will be created in the books/{cohort_name} folder as a Quarto book in html, word and pdf.\nAfter data harmonisation, data combining for all cohorts, data filtering and preliminary analysis will be done by copying _quarto_Prelim.yml file from the quarto-yaml-template folder to the project folder harmonisation_template and rename it as _quarto.yml, overwriting any existing _quarto.yml file. Using the _quarto.yml file, Quarto runs the Quarto scripts in the reports/Combine folder. Results will be outputted as excel files called harmonised.xlsx, harmonised_batch1.xlsx, harmonised_batch2.xlsx in the reports folder. In addition, the preliminary results will be created in the books/Prelim folder as a Quarto book in html, word and pdf.\nAfter doing this for each cohort, the script will then create a combined data harmonisation process documentation (for all the cohorts) as a Quarto book in html. The specific yml file (_quarto_all.yml) in the quarto-yaml-template folder will be used and the documentation will be created in the books/all folder. Data combining for all cohorts, data filtering and preliminary analysis will also be done by running Quarto scripts in the reports/Combine folder.",
    "crumbs": [
      "Preface"
    ]
  },
  {
    "objectID": "index.html#general-recommendations",
    "href": "index.html#general-recommendations",
    "title": "Harmonisation Template for Cohort A",
    "section": "General Recommendations",
    "text": "General Recommendations\n\nEnsure the workspace is always in a blank state. Use usethis::use_blank_slate(scope = c(\"user\", \"project\")) to create this setting.\nKeep the root of the project as clean as possible\nStore your raw data in data-raw\nDocument raw data modifications. See Flowchart.xlsx.\nExport modified raw data in reports/{cohort_name}_Cleaning/preprocessed_data\nStore only R functions in R/\nStore only R scripts and/or qmd in reports/{cohort_name}_Cleaning\nBuilt relative paths using here::here()\nCall external functions as {package_name}::{function()}\nUse devtools::document() to update the NAMESPACE\nUse rcompendium::add_dependencies to update the list of required dependencies in DESCRIPTION\nDo not source your functions but use instead devtools::load_all(). devtools::load_all() will load required dependencies listed in DESCRIPTION and R functions stored in R/",
    "crumbs": [
      "Preface"
    ]
  },
  {
    "objectID": "codes/Cohort_A/00_R_Package_And_Environment.html",
    "href": "codes/Cohort_A/00_R_Package_And_Environment.html",
    "title": "1  R Package And Environment",
    "section": "",
    "text": "1 R Packages Used\nHere are the R packages used in this analysis.\nCode\nif (params$show_table && knitr::is_html_output()) {\n  harmonisation::get_r_package_info() |&gt;\n    reactable::reactable()\n}",
    "crumbs": [
      "Cohort A Cleaning",
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>R Package And Environment</span>"
    ]
  },
  {
    "objectID": "codes/Cohort_A/00_R_Package_And_Environment.html#r-platform-information",
    "href": "codes/Cohort_A/00_R_Package_And_Environment.html#r-platform-information",
    "title": "1  R Package And Environment",
    "section": "2 R Platform Information",
    "text": "2 R Platform Information\nHere are the R platform environment used in this analysis.\n\n\nCode\nif (params$show_table && knitr::is_html_output()) {\n  r_platform_table &lt;- harmonisation::get_r_platform_info()\n  r_platform_table |&gt;\n    reactable::reactable(\n      defaultPageSize = 5\n    )\n}",
    "crumbs": [
      "Cohort A Cleaning",
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>R Package And Environment</span>"
    ]
  },
  {
    "objectID": "codes/Cohort_A/00_R_Package_And_Environment.html#data-dictionary",
    "href": "codes/Cohort_A/00_R_Package_And_Environment.html#data-dictionary",
    "title": "1  R Package And Environment",
    "section": "3 Data dictionary",
    "text": "3 Data dictionary\nCheck to see if the data dictionary 20250307_data_dictionary.xlsx exists.\n\n\nCode\ndict_relative_path &lt;- fs::path(\n  \"data-raw\",\n  \"data_dictionary\",\n  params$data_dictionary\n)\n\n\ndict_path &lt;- here::here(dict_relative_path)\n\nif (!file.exists(dict_path)) {\n  stop(glue::glue(\"Input data dictionary {dict_path} cannot be found\"))\n}",
    "crumbs": [
      "Cohort A Cleaning",
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>R Package And Environment</span>"
    ]
  },
  {
    "objectID": "codes/Cohort_A/01_Read_Cohort_A_Data.html",
    "href": "codes/Cohort_A/01_Read_Cohort_A_Data.html",
    "title": "2  Read Cohort A Data",
    "section": "",
    "text": "1 Read Data\nWe read the data and have the following warnings\nCode\ncohort_A_data &lt;- readxl::read_excel(\n  path = here::here(\"data-raw\",\n                    \"Cohort_A\",\n                    \"data_to_harmonise_age_issue.xlsx\"),\n  sheet = \"Sheet1\",\n  col_types = c(\n    \"text\", \"numeric\"\n    )\n  )\nThis warning occurs because we expect the second column Age to be numeric but there exists some text columns.\nSuppose we ask the collaborator to fix the age column and the collaborator returns a new file. To ensure that there are no messages, we can use testthat::expect_no_condition.\nHere is an example when it gives an error with the old file\nCode\ntestthat::expect_no_condition(\n  readxl::read_excel(\n  path = here::here(\"data-raw\",\n                    \"Cohort_A\",\n                    \"data_to_harmonise_age_issue.xlsx\"),\n  sheet = \"Sheet1\",\n  col_types = c(\n    \"text\", \"numeric\"\n    )\n  )\n)\n\n\nError: Expected `readxl::read_excel(...)` to run without any conditions.\nℹ Actually got a &lt;simpleWarning&gt; with text:\n  Expecting numeric in B7 / R7C2: got 'missing'\nWe can read the new file in the following way. However, this method means that you will need to read the file twice.\nCode\ntestthat::expect_no_condition(\n  readxl::read_excel(\n  path = here::here(\"data-raw\",\n                    \"Cohort_A\",\n                    \"data_to_harmonise_age_issue_fixed.xlsx\"),\n  sheet = \"Sheet1\",\n  col_types = c(\n    \"text\", \"numeric\"\n    )\n  )\n)\n\ncohort_A_data &lt;- readxl::read_excel(\n  path = here::here(\"data-raw\",\n                    \"Cohort_A\",\n                    \"data_to_harmonise_age_issue_fixed.xlsx\"),\n  sheet = \"Sheet1\",\n  col_types = c(\n    \"text\", \"numeric\"\n    )\n  )\nTo read the file only once, we can use the tee pipe operator %T&gt;%.\nCode\ncohort_A_data &lt;- readxl::read_excel(\n  path = here::here(\"data-raw\",\n                    \"Cohort_A\",\n                    \"data_to_harmonise_age_issue_fixed.xlsx\"),\n  sheet = \"Sheet1\",\n  col_types = c(\n    \"text\", \"numeric\"\n    )\n  ) %T&gt;%\n  testthat::expect_no_condition()",
    "crumbs": [
      "Cohort A Cleaning",
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Read Cohort A Data</span>"
    ]
  },
  {
    "objectID": "codes/Cohort_A/01_Read_Cohort_A_Data.html#check-for-unique-patient-id",
    "href": "codes/Cohort_A/01_Read_Cohort_A_Data.html#check-for-unique-patient-id",
    "title": "2  Read Cohort A Data",
    "section": "2 Check for unique patient id",
    "text": "2 Check for unique patient id\nWe can use pointblank::rows_distinct to check if the column Serial Number has unique values.\n\n\nCode\ncohort_A_data &lt;- readxl::read_excel(\n  path = here::here(\"data-raw\",\n                    \"Cohort_A\",\n                    \"data_to_harmonise_age_issue_fixed.xlsx\"),\n  sheet = \"Sheet1\",\n  col_types = c(\n    \"text\", \"numeric\"\n    )\n  ) %T&gt;%\n  testthat::expect_no_condition() |&gt; \n  dplyr::rename(cohort_unique_id = \"Serial Number\") |&gt; \n  # Remove rows when the ID value is NA\n  dplyr::filter(!is.na(.data[[\"cohort_unique_id\"]])) |&gt;\n  dplyr::mutate(\n    cohort_unique_id = as.character(cohort_unique_id)\n  ) |&gt; \n  # Remove white spaces in column names\n  dplyr::rename_all(stringr::str_trim) |&gt; \n  # Check if cohort id is unique\n  pointblank::rows_distinct(\n    columns = \"cohort_unique_id\",\n  )",
    "crumbs": [
      "Cohort A Cleaning",
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Read Cohort A Data</span>"
    ]
  },
  {
    "objectID": "codes/Cohort_A/01_Read_Cohort_A_Data.html#clean-age-columns",
    "href": "codes/Cohort_A/01_Read_Cohort_A_Data.html#clean-age-columns",
    "title": "2  Read Cohort A Data",
    "section": "3 Clean Age columns",
    "text": "3 Clean Age columns\nSometimes the collaborator will not give you a new file and will only respond with an email acknowledging that it is an error.\nYou will need to edit the values yourself. It is best not to edit the file as you may forget to make the manual change if the collaborator gives you a new version a few months later with the same error.\nIt is also advised to record such changes before data harmonisation.\nWe read the data with the some issues with the age.\n\n\nCode\ncohort_A_data &lt;- readxl::read_excel(\n  path = here::here(\"data-raw\",\n                    \"Cohort_A\",\n                    \"data_to_harmonise.xlsx\"),\n  sheet = \"Sheet1\",\n  col_types = c(\n    \"text\", \"text\", \"numeric\", \"numeric\", \"numeric\", \"numeric\",\n    \"numeric\", \"numeric\"\n    )\n  ) %T&gt;%\n  testthat::expect_no_condition() |&gt; \n  dplyr::rename(cohort_unique_id = \"Serial Number\") |&gt; \n  # Remove rows when the ID value is NA\n  dplyr::filter(!is.na(.data[[\"cohort_unique_id\"]])) |&gt;\n  dplyr::mutate(\n    cohort_unique_id = as.character(cohort_unique_id)\n  ) |&gt; \n  # Remove white spaces in column names\n  dplyr::rename_all(stringr::str_trim) |&gt; \n  # Check if cohort id is unique\n  pointblank::rows_distinct(\n    columns = \"cohort_unique_id\",\n  )\n\n\nAs the Age is a mixture of type text and numeric in Excel, we need to convert those in type text to the appropriate values.\n\n\nCode\ncohort_A_data &lt;- cohort_A_data |&gt;\n  dplyr::select(c(\"cohort_unique_id\", \"Age\")) |&gt;\n  dplyr::mutate(\n    `Age before` = .data[[\"Age\"]],\n    `Age` = dplyr::case_when(\n      .data[[\"Age\"]] == \"missing\" ~ NA,\n      .default = .data[[\"Age\"]]\n    ),\n    `Age before` = forcats::fct(\n      as.character(.data[[\"Age before\"]])\n    )\n  ) |&gt; \n  # Check that these are the only patients with missing age \n  pointblank::col_vals_null(\n    columns = c(\"Age\"),\n    preconditions = ~ . %&gt;% dplyr::filter(\n      .data[[\"cohort_unique_id\"]] %in% c(\"A006\", \"A013\")\n    )\n  )\n\n\n\n\nCode\nif (params$show_table && knitr::is_html_output()) {\n  cohort_A_data |&gt; \n    dplyr::select(\"cohort_unique_id\", \"Age before\", \"Age\") |&gt; \n    harmonisation::reactable_with_download_csv_button()\n}\n\n\n\n\n\n\nDownload as CSV\n\n\n\nRemove columns Age before.\n\n\nCode\ncohort_A_data &lt;- cohort_A_data |&gt;\n  dplyr::select(-c(\"Age before\"))",
    "crumbs": [
      "Cohort A Cleaning",
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Read Cohort A Data</span>"
    ]
  },
  {
    "objectID": "codes/Cohort_A/01_Read_Cohort_A_Data.html#check-corrections",
    "href": "codes/Cohort_A/01_Read_Cohort_A_Data.html#check-corrections",
    "title": "2  Read Cohort A Data",
    "section": "4 Check corrections",
    "text": "4 Check corrections\nWe check if the corrections are made based on the collaborator request are made.\n\nAge changed from missing to NA for patient A006 and A013.\n\n\n\nCode\ncohort_A_data |&gt;\n  # Check if these patient IDs are present\n  pointblank::expect_col_vals_make_subset(\n    columns = c(\"cohort_unique_id\"),\n    set = c(\"A006\", \"A013\")\n  ) |&gt;\n  pointblank::expect_col_exists(\n    columns = c(\"Age\")\n  ) |&gt;\n  pointblank::expect_col_vals_expr(\n    expr = pointblank::expr(\n      dplyr::case_when(\n      .data[[\"cohort_unique_id\"]] %in% \"A006\" ~ is.na(.data[[\"Age\"]])\n      )\n    )\n  ) |&gt;\n  pointblank::expect_col_vals_expr(\n    expr = pointblank::expr(\n      dplyr::case_when(\n      .data[[\"cohort_unique_id\"]] %in% \"A013\" ~ is.na(.data[[\"Age\"]])\n      )\n    )\n  )",
    "crumbs": [
      "Cohort A Cleaning",
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Read Cohort A Data</span>"
    ]
  },
  {
    "objectID": "codes/Cohort_A/01_Read_Cohort_A_Data.html#write-preprocessed-file",
    "href": "codes/Cohort_A/01_Read_Cohort_A_Data.html#write-preprocessed-file",
    "title": "2  Read Cohort A Data",
    "section": "5 Write Preprocessed File",
    "text": "5 Write Preprocessed File\nWe output data to be used for the next session.\n\n\nCode\ncohort_A_data |&gt;\n  fst::write_fst(\n    path = here::here(params$analysis_folder,\n                      params$harmonisation_folder,\n                      params$preprocessing_folder,\n                      \"01_Cohort_A_cleaned.fst\")\n)",
    "crumbs": [
      "Cohort A Cleaning",
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Read Cohort A Data</span>"
    ]
  }
]